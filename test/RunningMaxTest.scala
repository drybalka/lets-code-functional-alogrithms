def testRunningMaxWith(
    runningMax: Vector[Int] => Vector[Int],
    suite: munit.FunSuite
)(using
    loc: munit.Location
): Unit =

  suite.test("trivial"):
    suite.assertEquals(
      runningMax(Vector(1, 2, 3)),
      Vector(1, 2, 3),
      "Ascending collection does not change"
    )

  suite.test("first element is the largest"):
    suite.assertEquals(
      runningMax(Vector(5, 1, 2, 3)),
      Vector(5, 5, 5, 5),
      "Largest element in the first place is copied"
    )

  suite.test("non-trivial"):
    suite.assertEquals(
      runningMax(Vector(2, 1, 3, 5, 4)),
      Vector(2, 2, 3, 5, 5),
      "Several local maxima"
    )

  suite.test("large example"):
    suite.assertEquals(
      runningMax(
        Vector(0, 1, 2, 1, 3, 1, 1, 1, 4, 6, 7, 11, 4, 9, 7, 7, 12, 13, 1, 3, 7,
          9, 9, 16, 11, 21, 20, 18, 26, 8, 29, 3, 0, 10, 20, 3, 8, 10, 22, 38,
          36, 16, 8, 4, 22, 23, 21, 23, 37, 19, 14, 8, 13, 8, 25, 7, 28, 18, 47,
          57, 13, 1, 16, 1, 26, 23, 52, 37, 67, 35, 25, 61, 59, 29, 73, 71, 74,
          34, 48, 38, 38, 74, 26, 5, 3, 7, 26, 83, 30, 64, 86, 8, 19, 64, 80,
          14, 77, 50, 93, 53, 65, 18, 33, 43, 19, 66, 61, 44, 67, 64, 75, 73,
          39, 107, 96, 16, 34, 78, 83, 80, 75, 9, 85, 104, 23, 21, 91, 37, 124,
          14, 48, 117, 28, 9, 10, 69, 24, 96, 118, 130, 34, 131, 109, 133, 62,
          83, 134, 62, 113, 146, 113, 3, 110, 4, 55, 47, 11, 97, 112, 122, 79,
          147, 17, 42, 150, 91, 104, 30, 15, 2, 140, 27, 114, 143, 49, 29, 71,
          133, 95, 156, 143, 41, 150, 120, 179, 184, 91, 150, 18, 90, 132, 72,
          107, 4, 107, 181, 74, 140, 23, 19, 140, 200, 143, 197, 198, 205, 130,
          118, 80, 171, 117, 96, 184, 167, 106, 114, 123, 166, 199, 145, 94,
          208, 192, 33, 143, 140, 216, 28, 126, 45, 204, 47, 112, 25, 92, 170,
          74, 44, 121, 163, 13, 24, 145, 7, 152, 73, 35, 69, 57, 104, 250, 223,
          97, 44, 22, 101)
      ),
      Vector(0, 1, 2, 2, 3, 3, 3, 3, 4, 6, 7, 11, 11, 11, 11, 11, 12, 13, 13,
        13, 13, 13, 13, 16, 16, 21, 21, 21, 26, 26, 29, 29, 29, 29, 29, 29, 29,
        29, 29, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38,
        38, 38, 38, 47, 57, 57, 57, 57, 57, 57, 57, 57, 57, 67, 67, 67, 67, 67,
        67, 73, 73, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 83, 83, 83, 86,
        86, 86, 86, 86, 86, 86, 86, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93, 93,
        93, 93, 93, 93, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107,
        107, 107, 107, 107, 124, 124, 124, 124, 124, 124, 124, 124, 124, 124,
        124, 130, 130, 131, 131, 133, 133, 133, 134, 134, 134, 146, 146, 146,
        146, 146, 146, 146, 146, 146, 146, 146, 146, 147, 147, 147, 150, 150,
        150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 156,
        156, 156, 156, 156, 179, 184, 184, 184, 184, 184, 184, 184, 184, 184,
        184, 184, 184, 184, 184, 184, 184, 200, 200, 200, 200, 205, 205, 205,
        205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 208,
        208, 208, 208, 208, 216, 216, 216, 216, 216, 216, 216, 216, 216, 216,
        216, 216, 216, 216, 216, 216, 216, 216, 216, 216, 216, 216, 216, 216,
        250, 250, 250, 250, 250, 250),
      "Large example"
    )


class RunningMaxTestImperative extends munit.FunSuite:
  testRunningMaxWith(RunningMax.runningMax_imperative, this)


class RunningMaxTestFunctional extends munit.FunSuite:
  testRunningMaxWith(RunningMax.runningMax_functional, this)


class RunningMaxTestParallel extends munit.FunSuite:
  testRunningMaxWith(RunningMax.runningMax_parallel, this)
